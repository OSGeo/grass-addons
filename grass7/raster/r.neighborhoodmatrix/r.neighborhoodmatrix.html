<h2>DESCRIPTION</h2>

<p>
<em>r.neighborhoodmatrix</em> identifies all adjacency relations between
objects (aka segments or clumps identified by identical integer cell values of
adjacent pixels) in a raster map and exports these as a 2xn matrix 
where n is the number of neighborhood relations with each relation listed 
in both directions (i.e. if a is neighbor of b, the list will contain 
a,b and b,a). If a path to an output file is specified, the matrix will be
written to that file, otherwise it will be sent to standard output.

<p>
Neighborhood relations are determined pixel by pixel, and by default only 
pixels that share a common pixel boundary are considered neighbors. When
the <em>-d</em> flag is set pixels sharing a common corner (i.e. diagonal
neighbors) are also taken into account.

<p>
When the <em>-l</em> flag is set, the module additionally indicates the length
of the common border between two neighbors in number of pixels. As this length
is not clearly defined for diagonal neighbors, the <em>-l</em> flag cannot
be used in combination with the <em>-d</em> flag.

<p>
In order to speed up calculations, the user can set the parameter 
<em>processes</em> to the number of desired processes to run in parallel. As
the module parallelizes per direction, the maximum number of processes is 4
without and 8 with the <em>-d</em> flag.

<h2>NOTES</h2>

<p>
The module (without the <em>-d</em> flag) should give the same result as the equivalent call to 
<a href="v.neighborhoodmatrix.html">v.neighborhoodmatrix</a> with the <em>-b</em>
flag. Currently it actually seems faster for some maps to transform the raster 
to vector and then run the latter. More tests are needed, though, to confirm
this.

<p>
As neighborhood length is measured in pixels, this length is not in proportion 
to length in map units if the location is a lat-long location, or if the 
resolution is not the same in East-West and in North-South direction 
(rectangular pixels).


<h2>TODO</h2>

<ul>
	<li>Add flag to only output half matrix with each relation only shown 
		once.</li>
	<li>Measure neighbordhood length in map units, not only pixels</li>
</ul>

<h2>EXAMPLE</h2>

Send the neighborhood matrix of the counties in the boundary_county map of the 
North Carolina dataset to standard output:

<div class="code"><pre>
r.neighborhoodmatrix in=boundary_county_500m sep=comma
</pre></div>

Idem, but also calculating neighborhood length, sending the output to a file 
and using 4 parallel processes:

<div class="code"><pre>
r.neighborhoodmatrix -l n=boundary_county_500m sep=comma \
	output=county_neighbors.csv processes=4
</pre></div>

Transforming the raster to vector (without attribute table or topology) and using
<a href="v.neighborhoodmatrix.html">v.neighborhoodmatrix</a>:

<div class="code"><pre>
r.to.vect -tbv in=boundary_county_500m out=boundary_county_500m type=area
v.neighborhoodmatrix in=boundary_county_500m sep=comma
</pre></div>

<h2>SEE ALSO</h2>

<em>
<a href="v.neighborhoodmatrix.html">v.neighborhoodmatrix</a>
</em>

<h2>AUTHOR</h2>
 Moritz Lennert

<p><i>Last changed: $Date$</i>
