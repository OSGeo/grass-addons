<h2>OPTIONS</h2>
<dl>
<dt><b>-c</b></dt>
<dd>Print only catchment's characteristics. Useful for shell script calculation
or collecting data in external tables.</dd>
<dt><b>-o</b></dt>
<dd>Print only parameters for every order. Useful to visualise Horton's law with
external software (see example).</dd>
<dt><b>-m</b></dt>
<dd>Only for very large data sets. Use segment library to optimise memory
consumption during analysis.</dd>
<dt><b>stream_rast</b></dt>
<dd>Stream network: name of input stream raster map produced by r.watershed or 
r.stream.extract, on which ordering will be performed. Because stream network produced by
r.watershed and r.stream.extract may slighty differ in detail, it is required to
use both stream_rast and direction map produced by the same module. Stream_rast background
shall have NULL value or zero value. Background values of NULL are by default
produced by r.watershed and r.stream.extract. If not 0 or NULL use <a
href="r.mapcalc.html">r.mapcalc</a> to set background values to NULL.  
</dd>
<dt><b>direction</b></dt>
<dd>Flow direction: name of input direction map produced by r.watershed or
r.stream.extract. If r.stream.extract output map is used, it only has non-NULL
values in places where streams occur. NULL (nodata) cells are ignored, zero and
negative values are valid direction data if they vary from -8 to 8 (CCW from
East in steps of 45 degrees). Direction map shall be of type CELL values. Region
resolution and map resolution must be the same. 
Also <em>stream_rast</em> network map must have the same resolution. It is checked by
default. If resolutions differ the module informs about it and stops. Region
boundary and maps boundary may differ but it may lead to unexpected
results.</dd>

<dt><b>elevation</b></dt>
<dd>Elevation: name of input elevation map. Map can be of type CELL, FCELL or
DCELL. It is not restricted to resolution of region settings as stream_rast and
direction.</dd>

<h2>OUTPUTS</h2>
Output statistics are send to standard output. To redirect output to file use
redirection operators: > or >>. If redirection is used, output messages are
printed on stderr (usually terminal) while statistics are written to the file.
Statistics can be print as a formatted summary information with number of
parameters or as a catchement's descriptive statistics and table with statistics
for every order. 


<h2>DESCRIPTION</h2>
<p>
The module r.stream.stats is prepared to calculate Horton's statistics of drainage
network.
<p>
These statistics are calculated according to formulas given by R.Horton (1945).
Because Horton do not defined precisely what is stream slope, 2 different approaches 
have been proposed: the first (slope) uses cell-by-cell slope
calculation; the second (gradient) uses the difference between elevation of outlet and
source of every channel to its length to calculate formula. Bifurcation ratio
for every order is calculated acording to the formula: 
<code>n_streams[1]/n_stream[i+1]</code>
where i is the current order and i+1 is the next higher order. For max order of the map
number of streams is zero. Rest of the ratios are calculated in similar mode.
The bifurcation and other ratios for the whole catchment (map) is calculated as
mean i.e. sum of all bifurcation ratio / max_order-1 (for max_order stream
bifurcation ratio = 0).
It is strongly recommended to extract the stream network using basin map created
with r.stream.basins. If the whole stream order map is used, the calculation will be
performed but results may not have hydrological sense.

For every order (std) means that statistics are calculated with standard deviation:
<ul>
<li>number of streams
<li>total length of streams of a given order
<li>total area of basins of a given order 
<li>drainage density
<li>stream density

<li>average length of streams of a given order (std)
<li>average slope (cell by cell inclination) of streams of a given order (std)
<li>average gradient (spring to outlet inclination) of streams of a given order
(std)
<li>average area of basins of a given order (std)
<li>avarage elevation difference of a given order (std)
<p>ratios:
<li>bifuracation ratio
<li>length ratio
<li>slope and gradient ratios
<li>area ratio
</ul>
for the whole basin:
<ul>
<li>total number of streams
<li>total length of streams 
<li>total basin area
<li>drainage density
<li>stream density
<p>ratios:
<li>bifurcation ratio (std)
<li>length ratio (std)
<li>slope and gradient ratios (std)
<li>area ratio (std)
</ul>
<p>
For the whole basins ratios are calculated acording two formulas: as a mean of
ratios for every order, or as a antilog of slope coefficient of the regression
model: order vs. log10(parameter)

<h2>NOTES</h2>
<p>
The module calculates statistics for all streams in input stream_rast map. It is strongly
recommended to extract only network of one basin, but it is not necessary for
computation. Streams for the desired basin can be extracted by the following
r.mapcalc formula:

<p>
<code>echo 'sel_streams=if(basin==xxx,streams,null())' | r.mapcalc #xxx category
of desired basin</code>
<p>

It is also possible to calculate Horton's statistics for Shreve ordering but it
has no hydrological sense. Hack (or Gravelius hierarchy) main stream is not the
same what so called Horton's reverse ordering (see: Horton 1945).
<p>
The module can work only if direction map, stream_rast map and region have the same
settings. It is also required that stream_rast map and direction map come from the
same source. For lots of reason this limitation probably cannot be omitted.  
This means that if stream_rast map comes from r.stream.extract also direction map from
r.stream.extract must be used. If the stream network was generated with MFD method
also MFD direction map must be used.

<h2>EXAMPLE</h2>
Create table with order statistics. This table can easily be sent to external
program (like R) to be visualised:

<div class="code"><pre>
g.region -p -a rast=elevation align=elevation
r.watershed elevation=elevation threshold=10000 drainage=direction stream=streams
r.stream.stats stream_rast=horton direction=direction elevation=elevation
# export for processing in R
r.stream.stats -o stream_rast=horton direction=direction elevation=elevation > tmp_file
R
r=read.csv("tmp_file",skip=1,header=TRUE)
plot(num_of_streams~order,data=r,log="y", 
	main="Sperafish area", 
	sub=paste("Bifurcation ratio: ",
		round(1/10^model$coefficients[2],3)))
model=lm(log10(num_of_streams)~order,data=r)
abline(model)
</pre></div>

<h2>SEE ALSO</h2>

<em>
<a href="r.watershed.html">r.watershed</a>,
<a href="r.stream.extract.html">r.stream.extract</a>,
<a href="r.stream.order.html">r.stream.order</a>,
<a href="r.stream.basins.html">r.stream.basins</a>,
<a href="r.mapcalc.html">r.mapcalc</a>,
</em>

<h2>AUTHOR</h2>
Jarek Jasiewicz, Adam Mickiewicz University, Geoecology and Geoinformation
Institute.

<p><i>Last changed: $Date$</i>

